{
  "arn": "arn:aws:cloudformation:us-west-2::type/resource/AWS-GuardDuty-MalwareProtectionPlan",
  "type": "AWS::GuardDuty::MalwareProtectionPlan",
  "time": "2024-06-12T17:34:12.556Z",
  "schema": {
    "additionalProperties": false,
    "definitions": {
      "CFNActions": {
        "additionalProperties": false,
        "properties": {
          "Tagging": {
            "$ref": "#/definitions/CFNTagging",
            "description": "Indicates whether the scanned S3 object will have tags about the scan result."
          }
        },
        "type": "object"
      },
      "CFNProtectedResource": {
        "additionalProperties": false,
        "properties": {
          "S3Bucket": {
            "additionalProperties": false,
            "description": "Information about the protected S3 bucket resource.",
            "properties": {
              "BucketName": {
                "description": "Name of the S3 bucket.",
                "type": "string"
              },
              "ObjectPrefixes": {
                "description": "Information about the specified object prefixes. The S3 object will be scanned only if it belongs to any of the specified object prefixes.",
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            },
            "type": "object"
          }
        },
        "required": [
          "S3Bucket"
        ],
        "type": "object"
      },
      "CFNStatusReasons": {
        "additionalProperties": false,
        "properties": {
          "Code": {
            "description": "Issue code.",
            "type": "string"
          },
          "Message": {
            "description": "Issue message that specifies the reason.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "CFNTagging": {
        "additionalProperties": false,
        "properties": {
          "Status": {
            "description": "Indicates whether or not the tags will added.",
            "type": "string"
          }
        },
        "type": "object"
      },
      "TagItem": {
        "additionalProperties": false,
        "properties": {
          "Key": {
            "type": "string"
          },
          "Value": {
            "type": "string"
          }
        },
        "required": [
          "Key",
          "Value"
        ],
        "type": "object"
      }
    },
    "description": "Resource Type definition for AWS::GuardDuty::MalwareProtectionPlan",
    "handlers": {
      "create": {
        "permissions": [
          "guardduty:CreateMalwareProtectionPlan",
          "guardduty:GetMalwareProtectionPlan",
          "guardduty:TagResource",
          "iam:PassRole"
        ]
      },
      "delete": {
        "permissions": [
          "guardduty:DeleteMalwareProtectionPlan",
          "guardduty:GetMalwareProtectionPlan"
        ]
      },
      "list": {
        "permissions": [
          "guardduty:ListMalwareProtectionPlans"
        ]
      },
      "read": {
        "permissions": [
          "guardduty:GetMalwareProtectionPlan"
        ]
      },
      "update": {
        "permissions": [
          "guardduty:UpdateMalwareProtectionPlan",
          "guardduty:GetMalwareProtectionPlan",
          "guardduty:TagResource",
          "guardduty:UntagResource",
          "iam:PassRole"
        ]
      }
    },
    "primaryIdentifier": [
      "/properties/MalwareProtectionPlanId"
    ],
    "properties": {
      "Actions": {
        "$ref": "#/definitions/CFNActions",
        "description": "Information about whether the tags will be added to the S3 object after scanning."
      },
      "Arn": {
        "description": "Amazon Resource Name (ARN) of the protected resource.",
        "type": "string"
      },
      "CreatedAt": {
        "description": "The timestamp when the Malware Protection plan resource was created.",
        "type": "string"
      },
      "MalwareProtectionPlanId": {
        "description": "A unique identifier associated with Malware Protection plan resource.",
        "type": "string"
      },
      "ProtectedResource": {
        "$ref": "#/definitions/CFNProtectedResource",
        "description": "Information about the protected resource that is associated with the created Malware Protection plan. Presently, S3Bucket is the only supported protected resource."
      },
      "Role": {
        "description": "IAM role that includes the permissions required to scan and add tags to the associated protected resource.",
        "type": "string"
      },
      "Status": {
        "description": "Malware Protection plan status.",
        "type": "string"
      },
      "StatusReasons": {
        "description": "Information about the issue code and message associated to the status of your Malware Protection plan.",
        "items": {
          "$ref": "#/definitions/CFNStatusReasons"
        },
        "type": "array"
      },
      "Tags": {
        "items": {
          "$ref": "#/definitions/TagItem"
        },
        "type": "array"
      }
    },
    "readOnlyProperties": [
      "/properties/MalwareProtectionPlanId",
      "/properties/Arn",
      "/properties/CreatedAt",
      "/properties/Status",
      "/properties/StatusReasons"
    ],
    "required": [
      "Role",
      "ProtectedResource"
    ],
    "tagging": {
      "cloudFormationSystemTags": false,
      "tagOnCreate": true,
      "tagUpdatable": true,
      "taggable": true
    },
    "typeName": "AWS::GuardDuty::MalwareProtectionPlan"
  }
}